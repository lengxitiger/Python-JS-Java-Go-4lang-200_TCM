const path = require('path');
const os = require('os');
// const iconv = require('iconv-lite'); //è½¬GBKè¦è¿™ä¸ªåº“

// ç›¸å¯¹è·¯å¾„çš„å››ç§å†™æ³•           [ğŸ”½ğŸ”½ğŸ”½ğŸ”½ğŸ”½ğŸ”½ğŸ”½ğŸ”½ğŸ”½ğŸ”½]
const dirPath = path.resolve(__dirname, "ç›¸å¯¹ç»å¯¹è·¯å¾„è¡¥å……è¯´æ˜.js");  // éšå¼å†™æ³•ï¼ˆæ¨èï¼‰
const dirPath1 = path.resolve(__dirname, ".\\ç›¸å¯¹ç»å¯¹è·¯å¾„è¡¥å……è¯´æ˜.js"); // æ˜¾å¼[å•åæ–œæ†]+æ— rï¼ˆWindowsé£æ ¼ï¼‰
const dirPath2 = path.resolve(__dirname, "./ç›¸å¯¹ç»å¯¹è·¯å¾„è¡¥å……è¯´æ˜.js"); // æ˜¾å¼[æ­£å•æ–œæ†]å†™æ³•ï¼ˆè·¨å¹³å°æ¨èï¼‰
const dirPath3 = path.resolve(__dirname, ".\\\\ç›¸å¯¹ç»å¯¹è·¯å¾„è¡¥å……è¯´æ˜.js"); // æ˜¾å¼[å››åæ–œæ†]å†™æ³•  ä¸æ¨è

console.log("ğŸ’³ğŸ’³ğŸ’³ğŸ’³ğŸ’³ğŸ’³ ä»¥ä¸‹æ˜¯ç›¸å¯¹è·¯å¾„å››ç§å†™æ³•\n");
console.log(dirPath);  // è·å–å®Œæ•´è·¯å¾„ å†™æ³•1
console.log(dirPath1); // è·å–å®Œæ•´è·¯å¾„ å†™æ³•2
console.log(dirPath2); // è·å–å®Œæ•´è·¯å¾„ å†™æ³•3
console.log(dirPath3); // è·å–å®Œæ•´è·¯å¾„ å†™æ³•4

// ç»å¯¹è·¯å¾„çš„ä¸‰ç§å†™æ³• ç»å¯¹è·¯å¾„éƒ½æ˜¯æ˜¾å¼å†™æ³•---------------------------------------
const absPath = path.resolve("D:\\ad\\4languages\\å…¶ä»–ä»£ç è¡¥å……è¯´æ˜\\ç›¸å¯¹ç»å¯¹è·¯å¾„è¡¥å……è¯´æ˜.js");     // [åŒåæ–œæ†]å†™æ³•
const absPath1 = path.resolve("D:/ad/4languages/å…¶ä»–ä»£ç è¡¥å……è¯´æ˜/ç›¸å¯¹ç»å¯¹è·¯å¾„è¡¥å……è¯´æ˜.js");         // [æ­£å•æ–œæ†]å†™æ³•
const absPath2 = path.resolve("D:\\\\ad\\\\4languages\\\\å…¶ä»–ä»£ç è¡¥å……è¯´æ˜\\\\ç›¸å¯¹ç»å¯¹è·¯å¾„è¡¥å……è¯´æ˜.js"); // [å››åæ–œæ†]å†™æ³• ä¸æ¨è

console.log("\nğŸ§°ğŸ§°ğŸ§°ğŸ§°ğŸ§°ğŸ§° ä»¥ä¸‹æ˜¯ç»å¯¹è·¯å¾„ä¸‰ç§å†™æ³•");
console.log(absPath);  // è·å–ç»å¯¹è·¯å¾„æ–‡ä»¶ç›®å½• å†™æ³•1
console.log(absPath1); // è·å–ç»å¯¹è·¯å¾„æ–‡ä»¶ç›®å½• å†™æ³•2
console.log(absPath2); // è·å–ç»å¯¹è·¯å¾„æ–‡ä»¶ç›®å½• å†™æ³•3


console.log("\nğŸ†ğŸ†ğŸ†ğŸ†ğŸ†ğŸ† ä»¥ä¸‹æ˜¯å…¶ä»–é«˜é˜¶å¼•ç”¨å†™æ³•,å¼€å‘äººå‘˜å¿…ä¼š");

// -------------------------------
// çˆ¶ç›®å½•å¼•ç”¨å†™æ³•
// -------------------------------
const dirPath4 = path.resolve(__dirname, "../å…¶ä»–ä»£ç è¡¥å……è¯´æ˜/ç›¸å¯¹ç»å¯¹è·¯å¾„è¡¥å……è¯´æ˜.js");
console.log(`\nçˆ¶ç›®å½•å¼•ç”¨: ${dirPath4}`);

// -------------------------------
// è·¨å¹³å°å®‰å…¨å†™æ³•ï¼ˆæ¨èï¼ï¼‰
// -------------------------------
const dirPath5 = path.resolve(__dirname, "4languages", "å…¶ä»–ä»£ç è¡¥å……è¯´æ˜", "ç›¸å¯¹ç»å¯¹è·¯å¾„è¡¥å……è¯´æ˜.js");
console.log(`è·¨å¹³å°æ‹¼æ¥: ${dirPath5}`);


// -------------------------------
// ç¯å¢ƒå˜é‡åŠ¨æ€è·¯å¾„ï¼ˆç”Ÿäº§ç¯å¢ƒå¸¸ç”¨ï¼‰
// -------------------------------
// æ³¨æ„ï¼šNode.js ä¸­å¯¹åº”çš„æ˜¯ process.env.USERPROFILEï¼ˆWindowsï¼‰æˆ– process.env.HOMEï¼ˆmacOS/Linuxï¼‰
const userHome = process.env.USERPROFILE || process.env.HOME; // è·¨å¹³å°å…¼å®¹è·å–ç”¨æˆ·ç›®å½•
if (!userHome) {
    console.warn("âš ï¸ æœªæ£€æµ‹åˆ°ç”¨æˆ·ä¸»ç›®å½•ç¯å¢ƒå˜é‡ USERPROFILE æˆ– HOME");
}

const absPath3 = path.resolve(userHome, "4languages", "ç›¸å¯¹ç»å¯¹è·¯å¾„è¡¥å……è¯´æ˜.js");
console.log(`\nç¯å¢ƒå˜é‡è·¯å¾„: ${absPath3}`);


// -------------------------------
// UNCç½‘ç»œè·¯å¾„ï¼ˆä¼ä¸šå¼€å‘å¿…å¤‡ï¼‰
// -------------------------------
// UNC è·¯å¾„åœ¨ Windows ä¸Šæ˜¯ \\host\share\...ï¼ŒNode.js å¯ä»¥ç›´æ¥å¤„ç†è¿™ç§å­—ç¬¦ä¸²
const absPath4 = path.resolve("\\\\192.168.1.1\\å…±äº«æ–‡ä»¶å¤¹\\test.js");
console.log(`UNCç½‘ç»œè·¯å¾„: ${absPath4}`);


// -------------------------------
// çŸ­æ–‡ä»¶åå…¼å®¹ï¼ˆå¤å¤ä½†æœ‰ç”¨ï¼‰
// -------------------------------
// Windows çš„çŸ­æ–‡ä»¶åï¼ˆå¦‚ D:\AD~1\...ï¼‰ï¼ŒNode.js å­—ç¬¦ä¸²å¯ä»¥åŸæ ·æ”¯æŒï¼Œä½†å®é™…æ–‡ä»¶ç³»ç»Ÿéœ€å­˜åœ¨è¯¥çŸ­å
const absPath5 = path.resolve("D:\\AD~1\\4LAN~1\\ç›¸å¯¹ç»å¯¹è·¯å¾„è¡¥å……è¯´æ˜.js");
console.log(`\nçŸ­æ–‡ä»¶åå…¼å®¹: ${absPath5}`);


// -------------------------------
// åŸå§‹ bytes è·¯å¾„ï¼ˆæç«¯æƒ…å†µå¤„ç†ï¼‰
// -------------------------------
// Node.js ä¸­æ²¡æœ‰ç›´æ¥çš„ bytes ç±»å‹åƒ Python çš„ b''ï¼Œä½†å¯ä»¥ç”¨ Buffer æ¨¡æ‹Ÿ
// Windows ä¸­æ–‡ç¯å¢ƒä¸‹å¸¸è§ç¼–ç æœ‰ gbk / utf8ï¼Œè¿™é‡Œç”¨ gbk æ¼”ç¤ºè§£ç 
const pathBytes = Buffer.from("D:\\ad\\test.txt"); // æ¨¡æ‹Ÿ bytes æ•°æ®
// æ³¨æ„ï¼šå®é™…é¡¹ç›®ä¸­é‡åˆ°é UTF-8 æ–‡ä»¶è·¯å¾„ï¼Œå¯èƒ½éœ€è¦æ ¹æ®ç³»ç»Ÿç¯å¢ƒè½¬ç ï¼Œæ¯”å¦‚ utf8
console.log(`bytesè·¯å¾„: ${pathBytes.toString('utf8')}`); // æ¨¡æ‹Ÿ utf8 è§£ç 


// -------------------------------
// è·¯å¾„è¯Šæ–­å‡½æ•°ï¼ˆpath_doctorï¼‰
// -------------------------------
function pathDoctor(inputPath) {
    console.log(`\nè¯Šæ–­æŠ¥å‘Šï¼š`);
    console.log(`åŸå§‹è·¯å¾„: ${inputPath}`);

    // ç»å¯¹è·¯å¾„
    const abs = path.resolve(inputPath);
    console.log(`ç»å¯¹è·¯å¾„: ${abs}`);

    // è§„èŒƒåŒ–è·¯å¾„ï¼ˆå»é™¤ ./ ../ ç­‰å†—ä½™éƒ¨åˆ†ï¼‰
    const normalized = path.normalize(inputPath);
    console.log(`è§„èŒƒåŒ–: ${normalized}`);

    // åˆ¤æ–­æ–‡ä»¶/ç›®å½•æ˜¯å¦å­˜åœ¨
    // æ³¨æ„ï¼šNode.js ä¸­æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨å»ºè®®ç”¨ fs.existsSync (åŒæ­¥) æˆ– fs.promises.access (å¼‚æ­¥)
    const fs = require('fs');
    const exists = fs.existsSync(abs);
    console.log(`å­˜åœ¨?: ${exists ? 'âœ…' : 'âŒ'}`);
}

// è°ƒç”¨è¯Šæ–­å‡½æ•°
pathDoctor("ç›¸å¯¹ç»å¯¹è·¯å¾„è¡¥å……è¯´æ˜.js");